<% provide(:title, @cuco_session.name) %>

<h2>Session <%= @cuco_session.name %></h2>

<% if user_signed_in? and current_user.can? :show, DatesController %>
  <h3>Dates</h3>
  <% if @cuco_session.dates == nil %>
    <% if user_signed_in? and current_user.can? :edit, DatesController %>
      Edit this session to have dates automatically calculated
    <% end %>
  <% else %>
    Show <%= link_to "dates", cuco_session_dates_path(@cuco_session, @cuco_session.dates) %>
  <% end %>
<% end %>

<h3>Courses (<%= @cuco_session.courses.count %>)
  <%= link_to image_tag('add.png'), new_cuco_session_course_path(@cuco_session), title: "Add New Class to Session" %></h3>
  <% if @cuco_session.courses.any? %>
    <ul>
    <% @cuco_session.courses.each do |course| %>
      <li><%= link_to course.title, [@cuco_session, course] %></li>
    <% end %>
    </ul>
  <% end %>
  
<h3>People</h3>
  <h4>Kids (<%= @cuco_session.kids.count %>)</h4>
  <div>
  <% @cuco_session.kids.each do |kid| %>
    <%= kid.first_name %> <%= kid.last_name %>,
  <% end %>
  </div>
  <div>
  <h4>Adults (<%= @cuco_session.adults.count %>)</h4>
  <% @cuco_session.adults.each do |adult| %>
    <%= adult.first_name %> <%= adult.last_name %>,
  <% end %>
  </div>

<h3>Families (<%= @cuco_session.families.count %>)</h3>
<div>
<% @cuco_session.families.each do |family| %>
  <%= family.name %>,
<% end %>
</div>


<% if user_signed_in? and current_user.can? :edit, CucoSessionsController %>
  <%= link_to 'Edit', edit_cuco_session_path(@cuco_session) %> |
<% end %>
<% if user_signed_in? and current_user.can? :destroy, CucoSessionsController and
       GoogleAPI.check_authorization?(current_user) %>
  <%= link_to 'Destroy', @cuco_session, method: :delete, data: { confirm: 'Are you sure?' } %> |
<% end %>
<%= link_to "Back to Sessions", cuco_sessions_path %>
